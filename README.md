# Фінальне домашнє завдання

### Технічний опис завдання

- **Створення документації за допомогою Sphinx.** За допомогою Sphinx створіть документацію для вашого застосунку.
  Для цього додайте в основних модулях до необхідних функцій і методів класів рядки `docstrings`.
- **Модульне тестування.** Покрийте модульними тестами модулі репозиторію вашого застосунку.
- **Інтеграційне тестування.** Покрийте інтеграційними тестами маршрути вашого застосунку, використовуючи фреймворк `pytest`.
- **Покриття тестами понад 75%.** Покрийте ваш застосунок тестами на понад 75%. Для контролю використовуйте пакет `pytest-cov`.
- **Реалізація кешування з Redis.** Реалізуйте механізм кешування за допомогою бази даних Redis.
  Виконайте кешування поточного користувача під час авторизації, щоб функція `get_current_user` брала користувача з кешу і не зверталася щоразу до бази даних.
- **Механізм скидання пароля.** Реалізуйте механізм скидання пароля для застосунку REST API.
- **Ролі користувачів і доступ.** Реалізуйте для користувачів застосунку доступ за ролями: «user» та «admin».
  Забезпечте, щоб тільки адміністратори могли самостійно змінювати свій аватар за замовчуванням.

### Додаткове завдання (не обов'язкове)

- Пара токенів `access_token` і `refresh_token`. Реалізуйте механізм авторизації застосунку за допомогою JWT токенів, використовуючи пару токенів: токен доступу `access_token` і токен оновлення `refresh_token`.

### Налаштування середовища і запуск програми

1. Перейдіть в діректорію проекта:

`cd goit-pythonweb-hw-12`

2. Створіть та налаштуйте .env файл у корені проєкту за прикладом:

```
JWT_SECRET=<your jwt secret>

DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=<your db password>
DB_PORT=5432
DB_HOST=db
DB_URL=postgresql+asyncpg://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

REDIS_URL=redis://redis:6379

MAIL_USERNAME=<your email address>
MAIL_PASSWORD=<your email password>
MAIL_FROM=<your email address>

CLD_NAME=<your cloudinary name>
CLD_API_KEY=<your cloudinary API key>
CLD_API_SECRET=<your cloudinary API secret>
```

3. Використайте Docker Compose для побудови і запуску середовища:

`docker-compose up --build`

4. Для взаємодії з сервером ми можемо надсилати запити за допомогою Swagger за адресою http://127.0.0.1:8000/docs#/.

### Документація

Щоб згенерувати документацію за допомогою Sphinx

1. Виконайте команду Windows:

```
.\\make.bat html
```

Linux:

```
make html
```

2. Відкрийте в браузері `docs/_build/html/index.html`

### Тестування

1. Для запуску тестів виконайте команду

```
pytest tests/
```

2. Для генерації звіту по покриттю тестами у html форматі виконайте команду

```
pytest --cov=src tests/ --cov-report=html
```
